@BASE = http://localhost:8080

@ACCESS = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJjbWlkNGNoYjQwMDAwMHkwd2pkODZoYnc0IiwibG9naW5JZCI6InNhaW0iLCJ0eXBlIjoiYWNjZXNzIiwianRpIjoiMWJiMDQ2YTctODkzMS00ZDU1LTgxOTQtZjk3MzMyMGIzMmM1IiwiaWF0IjoxNzY1MjY4MDYxLCJleHAiOjE3NjUyNjg5NjF9.rsFWNB3uU-H4qybkWSuhSd14S46pFULTlqWYyjGugQA
@REFRESH = paste_refresh_token_here
@GEMINI_MODEL = gemini-1.5-flash-latest

### Sign Up
POST {{BASE}}/api/auth/signup
Content-Type: application/json

{
  "loginId": "saim",
  "password": "123456789!",
  "name": "김예은",
  "gender": "F",
  "phone": "010-3370-7588",
  "birthDate": "2004-02-12",
  "smsConsent": true,
  "termsConsent": true
}

### Login
POST {{BASE}}/api/auth/login
Content-Type: application/json

{
  "loginId": "saim",
  "password": "123456789!"
}

### Get Profile
GET {{BASE}}/api/me
Authorization: Bearer {{ACCESS}}

### Update Profile (any subset of fields)
PATCH {{BASE}}/api/me
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "name": "김예니",
  "phone": "010-7588-3370",
  "gender": "F",
  "birthDate": "2001-01-01"
}

### Refresh Tokens
POST {{BASE}}/api/auth/refresh
Content-Type: application/json

{
  "refreshToken": "{{REFRESH}}"
}

### Logout
POST {{BASE}}/api/auth/logout
Content-Type: application/json

{
  "refreshToken": "{{REFRESH}}"
}

### Change Password
PATCH {{BASE}}/api/me/password
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "currentPassword": "123456789!",
  "newPassword": "987654321!"
}

### Social Login (Kakao)
POST {{BASE}}/api/auth/social/login
Content-Type: application/json

{
  "provider": "kakao",
  "code": "kakao_authorization_code_here",
  "redirectUri": "http://localhost:5173/auth/kakao/callback"
}

### Social Login (Google)
POST {{BASE}}/api/auth/social/login
Content-Type: application/json

{
  "provider": "google",
  "accessToken": "google_user_access_token_here"
}

### Complete Social Consent
POST {{BASE}}/api/auth/social/consent
Content-Type: application/json

{
  "pendingToken": "pending_token_from_login_response",
  "termsConsent": true,
  "smsConsent": false,
  "name": "소셜 사용자"
}

########################################################

### 방(ROOM) 도메인 테스트 (로컬 서버 기준)

### 1. 방 생성 (로컬)
### - JWT는 위에서 로그인 해서 직접 복사해 넣기 (@ACCESS 갱신 필수!)

POST {{BASE}}/api/rooms
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "title": "ㅇㅅㅇ22",
  "departureLabel": "전북대 구정문",
  "departureLat": 35.846100,
  "departureLng": 127.129100,
  "arrivalLabel": "전주 시외버스터미널",
  "arrivalLat": 35.825000,
  "arrivalLng": 127.148000,
  "departureTime": "2025-11-20T15:30:00.000Z",
  "capacity": 4,
  "priority": "time",
  "estimatedFare": 12000
}

### 방 생성 후, 응답 JSON에서 "id" 값을 복사해서
@ROOM_ID = cmiyb72ot000t0yx4zf33xvc1

### 2. 방 목록 조회 (전체)
GET {{BASE}}/api/rooms
Authorization: Bearer {{ACCESS}}

### 2-1. 내가 만든/참여한 방 목록 조회 (mine=true)
GET {{BASE}}/api/rooms?mine=true
Authorization: Bearer {{ACCESS}}

### 2-2. 특정 방 상세 정보 확인 (참여자/정산 상태 체크)
GET {{BASE}}/api/rooms/{{ROOM_ID}}
Authorization: Bearer {{ACCESS}}

### --- 시나리오 테스트 템플릿 ---
### 공통 변수는 필요 시 아래처럼 추가해서 사용
# @SETTLEMENT_ROOM_ID = {{ROOM_ID}}
@PAYMENT_SESSION_ID = b92d1988-74e7-40bf-b99c-55a47f47b94d

### 3. 지갑 잔액 조회
GET {{BASE}}/api/wallet/balance
Authorization: Bearer {{ACCESS}}

### 4. 지갑 충전 (Top-up)
POST {{BASE}}/api/wallet/topup
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "roomId": "{{ROOM_ID}}",
  "amount": 10000,
  "idempotencyKey": "topup-{{ROOM_ID}}-{{$timestamp}}"
}

### 5. 지갑 차감/환불 (Charge)
POST {{BASE}}/api/wallet/charge
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "roomId": "{{ROOM_ID}}",
  "kind": "hold_deposit",
  "amount": 5000,
  "allowNegative": false,
  "idempotencyKey": "charge-{{ROOM_ID}}-{{$timestamp}}",
  "metadata": {
    "note": "scenario test"
  }
}

### 6. 결제 세션 생성 (Mock PG)
POST {{BASE}}/api/payments/mock/session
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "amount": 15000,
  "currency": "KRW",
  "purpose": "wallet_topup",
  "roomId": "{{ROOM_ID}}",
  "metadata": {
    "memo": "wallet scenario"
  }
}

### 7. 결제 세션 성공 처리 (sessionId를 응답에서 복사)
POST {{BASE}}/api/payments/mock/session/{{PAYMENT_SESSION_ID}}/confirm
Authorization: Bearer {{ACCESS}}

### 8. 결제 세션 실패 처리 (테스트용)
POST {{BASE}}/api/payments/mock/session/{{PAYMENT_SESSION_ID}}/fail
Authorization: Bearer {{ACCESS}}

### 9. 결제 세션 목록 확인
GET {{BASE}}/api/payments/mock/sessions
Authorization: Bearer {{ACCESS}}

### 10. 정산 - 예치금 홀드
POST {{BASE}}/api/settlements/rooms/{{ROOM_ID}}/hold
Authorization: Bearer {{ACCESS}}

### 11. 정산 - 최종 정산
POST {{BASE}}/api/settlements/rooms/{{ROOM_ID}}/finalize
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "actualFare": 13000
}

### 12. 알림 목록 (메모리 저장된 알림 확인)
GET {{BASE}}/api/notifications
Authorization: Bearer {{ACCESS}}

### 13. 알림 발송 테스트
POST {{BASE}}/api/notifications/test
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "title": "시나리오 테스트",
  "body": "결제/정산 후 알림 확인"
}

### 14. 후기 작성
POST {{BASE}}/api/reviews
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "roomId": "{{ROOM_ID}}",
  "rating": 5,
  "comment": "매우 만족한 택시 동승 경험"
}

### 15. 방 후기 목록 조회
GET {{BASE}}/api/reviews/room/{{ROOM_ID}}
Authorization: Bearer {{ACCESS}}

### 16. 내 후기 목록
GET {{BASE}}/api/reviews/me
Authorization: Bearer {{ACCESS}}

### 17. 신고 작성
POST {{BASE}}/api/reports
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "roomId": "{{ROOM_ID}}",
  "reportedSeatNumber": 2,
  "message": "지각으로 인한 신고 테스트"
}

### 18. 방 신고 목록 조회
GET {{BASE}}/api/reports/room/{{ROOM_ID}}
Authorization: Bearer {{ACCESS}}

### 19. 내 신고 목록
GET {{BASE}}/api/reports/me
Authorization: Bearer {{ACCESS}}

### 20. 내 이용 기록 (마이페이지)
GET {{BASE}}/api/rides/history
Authorization: Bearer {{ACCESS}}

### 21. 이용 기록 + 후기 확인 셀프 시나리오
# 1) 위 10~11(hold/finalize) 호출 후
# 2) 후기 작성(14)까지 완료하고
# 3) 아래 요청을 다시 보내면 histories 배열에 방 정보 + 후기 여부가 나타납니다.
GET {{BASE}}/api/rides/history
Authorization: Bearer {{ACCESS}}

########################################################

### 방(ROOM) 도메인 테스트 (로컬 서버 기준)

########################################################



### 1. 방 생성 (로컬)

### - JWT는 위에서 로그인 해서 직접 복사해 넣기 (@ACCESS 갱신 필수!)

POST {{BASE}}/api/rooms
Authorization: Bearer {{ACCESS}}
Content-Type: application/json


{
  "title": "11/30 22:39",
  "departureLabel": "창의",
  "departureLat": 35.846100,
  "departureLng": 127.129100,
  "arrivalLabel": "공7",
  "arrivalLat": 35.825000,
  "arrivalLng": 127.148000,
  "departureTime": "2025-11-30T24:00:00.000Z",
  "capacity": 4,
  "priority": "time",
  "estimatedFare": 7000
}



### ⚠ 방 생성 후, 응답 JSON에서 "id" 값을 복사해서

###    아래 @ROOM_ID 자리에 넣어줘야 해


### 2. 방 목록 조회 (전체)

GET {{BASE}}/api/rooms
Authorization: Bearer {{ACCESS}}



### 3. 방 검색 (출발지 필터 + 자리 남은 방만)

GET {{BASE}}/api/rooms?departureLabel=강남역&hasSeat=true
Authorization: Bearer {{ACCESS}}



### 4. 방 상세 조회

GET {{BASE}}/api/rooms/{{ROOM_ID}}
Authorization: Bearer {{ACCESS}}



### 5. 방 수정 (방장 계정으로만 테스트!)

PATCH {{BASE}}/api/rooms/{{ROOM_ID}}
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{

  "title": "전북대 → 고속버스터미널",

  "departureTime": "2025-11-20T16:00:00.000Z",

  "estimatedFare": 13000

}



########################################################

### 방 참여 / 나가기 테스트

########################################################



### 7. 방 참여 (좌석 선택)

### - 현재 로그인한 사용자(@ACCESS)로, 위에서 만든 ROOM_ID 방에 참여

POST {{BASE}}/api/rooms/{{ROOM_ID}}/join
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{

  "seatNumber": 4

}



### 8. 방 나가기

### - 바로 위에서 참여한 사용자가 방에서 나가기

POST {{BASE}}/api/rooms/{{ROOM_ID}}/leave
Authorization: Bearer {{ACCESS}}



########################################################

### 방 매칭(matchRooms) 테스트

########################################################



### 9. 매칭 테스트 - 현재 위치 기준 반경 3km 안, 좌석 1자리 이상 남은 open 방

GET {{BASE}}/api/rooms/match?departureLat=35.8461&departureLng=127.1291&radiusKm=3&seatsNeeded=1
Authorization: Bearer {{ACCESS}}



### 10. 매칭 테스트 - 시간 조건 포함 (오늘 ~ 내일)

GET {{BASE}}/api/rooms/match?departureLat=35.8461&departureLng=127.1291&radiusKm=3&seatsNeeded=1&earliest=2025-11-20T00:00:00.000Z&latest=2025-11-21T00:00:00.000Z
Authorization: Bearer {{ACCESS}}



########################################################

### 방 정렬(sortBy) 테스트

########################################################



### 11. 정렬 - 출발지 가까운 순

### - refLat/refLng에 현재 위치(또는 희망 출발지) 위도/경도 입력

GET {{BASE}}/api/rooms?sortBy=departureDistance&refLat=35.1796&refLng=129.0756
Authorization: Bearer {{ACCESS}}



### 12. 정렬 - 도착지 가까운 순

GET {{BASE}}/api/rooms?sortBy=arrivalDistance&refLat=35.1796&refLng=129.0756
Authorization: Bearer {{ACCESS}}



### 13. 정렬 - 출발 시간 가까운 순

GET {{BASE}}/api/rooms?sortBy=time
Authorization: Bearer {{ACCESS}}


### 나의 방

### 나의 방 목록
GET {{BASE}}/api/rooms/mine
Authorization: Bearer {{ACCESS}}



########################################################

### Uber 호출 테스트

########################################################

### Uber 딥링크 생성 (GET 지원 안해서 POST 사용)
POST {{BASE}}/api/rides/uber/deeplink
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "pickupLat": 37.498004,
  "pickupLng": 127.027706,
  "pickupNickname": "강남역 2번 출구",
  "dropoffLat": 37.507341,
  "dropoffLng": 127.029317,
  "dropoffNickname": "강남역 1번 출구",
  "note": "테스트 호출"
}

### 방 내부에서 호출 요청 (룸 상태에 deeplink/stage 반영)
### 여기서는 실제 존재하는 ROOM_ID 를 넣어주세요.
POST {{BASE}}/api/rooms/{{ROOM_ID}}/ride/request
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "pickupLat": 37.498004,
  "pickupLng": 127.027706,
  "pickupNickname": "강남역 2번 출구",
  "dropoffLat": 37.507341,
  "dropoffLng": 127.029317,
  "dropoffNickname": "강남역 1번 출구",
  "note": "방 내부 호출 테스트"
}

### 호출 상태 조회
GET {{BASE}}/api/rooms/{{ROOM_ID}}/ride-state
Authorization: Bearer {{ACCESS}}

### (호스트 전용) 호출 단계 업데이트
POST {{BASE}}/api/rooms/{{ROOM_ID}}/ride/stage
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "stage": "dispatching",
  "driverName": "홍길동",
  "carModel": "Avante",
  "carNumber": "12가 3456",
  "note": "기사님 곧 도착"
}

########################################################

### Gemini ��� ���� �ݾ� ���� + ������ �ڵ����� (���)
POST {{BASE}}/api/payments/ocr/estimate
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "imageBase64": "iVBORw0KGgoAAAANSUhEUgAAAAUA...", // png/jpg base64
  "mimeType": "image/png",
  "roomId": "{{ROOM_ID}}",
  "model": "{{GEMINI_MODEL}}"
}

### gemini 결제??
POST {{BASE}}/api/payments/ocr/estimate
Authorization: Bearer {{ACCESS}}
Content-Type: application/json

{
  "imageBase64": "<실제 base64 전체>",
  "mimeType": "image/png",
  "model": "models/gemini-2.0-flash-001",
  "apiVersion": "v1"
}

########################################################

### 지갑 영수증 OCR + 자동충전 (multipart 업로드)
# FormData로 이미지 파일을 보낼 때 사용 예시입니다.
# 파일 경로는 로컬 캡처 이미지로 교체하세요.
POST {{BASE}}/api/wallet/receipt/amount
Authorization: Bearer {{ACCESS}}
Content-Type: multipart/form-data; boundary=boundary

--boundary
Content-Disposition: form-data; name="image"; filename="uber_capture.png"
Content-Type: image/png

< C:\Users\82103\Downloads\uber_capture.png
--boundary--

@GEMINI_API_KEY=AIzaSyA1plfW6fG-wG2yVJxacm-Qf7ee1Rwc0PQ

### listModels
GET https://generativelanguage.googleapis.com/v1/models?key={{GEMINI_API_KEY}}

